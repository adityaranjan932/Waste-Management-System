<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ola Maps Test</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <style>
      #map {
        height: 100vh;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      // Initialize the map
      const map = L.map("map").setView([28.6139, 77.209], 13); // Default to Delhi coordinates

      // Add OpenStreetMap tiles
      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
      }).addTo(map);

      // Function to fetch route from Ola Maps API
      async function fetchRoute() {
        const origin = "26.832332,80.921505"; // Example origin (Delhi)
        const destination = "26.930497,80.939004"; // Example destination (Delhi)
        const waypoints = ""; // Add waypoints if needed

        try {
          console.log("Fetching route from Ola Maps API...");
          const response = await fetch(
            `https://api.olamaps.com/directions?origin=${origin}&destination=${destination}&waypoints=${waypoints}&api_key=1CUB0cWgE2Ye77gQdBFnLsQgGvb7qZ4xtn5sQa4S`
          );

          if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
          }

          const data = await response.json();
          console.log("API Response:", data);

          if (data.routes && data.routes.length > 0) {
            const route = data.routes[0];
            const coordinates = route.geometry.coordinates.map((coord) => [
              coord[1],
              coord[0],
            ]); // Convert to [lat, lng]

            // Draw the route on the map
            L.polyline(coordinates, { color: "blue" }).addTo(map);

            // Fit the map to the route
            map.fitBounds(L.polyline(coordinates).getBounds());
          } else {
            alert("No route found!");
            console.error("No routes available in the API response.");
          }
        } catch (error) {
          console.error("Error fetching route:", error);
          alert("Failed to fetch route. Check the console for details.");
        }
      }

      // Fetch and display the route on page load
      fetchRoute();
    </script>
  </body>
</html>
